module Main {

struct Foo {}

instance Drop[Foo] {
    fn drop(self) -> Self {
        bar();
        self
    }
}

pub effect Bar {
    fn bar()
}

fn foo() {
    println("Hello from foo");
}

fn baz() {
    println("Hello from baz");
}

fn main() {
    with bar = foo {
        bar();
        let f = Foo();
    }
    with bar = baz {
        bar();
        let f = Foo();
    }
}

}
