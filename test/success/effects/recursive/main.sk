module Main {

pub effect Bar {
    fn bar()
}

fn foo() {
    println("Hello from foo");
}

fn baz() {
    println("Hello from baz");
}

fn recursive(v: Bool) {
    if v {
        with bar = baz {
            bar();
            recursive(False);
        }
        println("Should be foo");
        recursive(False);
    } else {
        bar();
        println("Reached the base case");
    }
}

fn main() {
    with bar = foo {
        bar();
        recursive(True);
    }
}

}
